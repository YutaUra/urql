import{share as e,mergeMap as r,filter as t,takeUntil as n,merge as o,make as a}from"wonka";import{subscribe as i,execute as l}from"graphql";import{getOperationName as u,makeResult as s,makeErrorResult as c,mergeResultPatch as v}from"@urql/core";var d="undefined"!=typeof Symbol?Symbol.asyncIterator:null,f=({schema:f,rootValue:m,context:b,fieldResolver:p,typeResolver:y,subscribeFieldResolver:h})=>({forward:x})=>k=>{var R=e(k),V=r((e=>{var{key:r}=e,o=t((e=>"teardown"===e.kind&&e.key===r))(R),x="function"==typeof b?b(e):b,k=Object.create(null);if(e.variables)for(var V in e.variables)void 0!==e.variables[V]&&(k[V]=e.variables[V]);return n(o)(((e,r)=>a((t=>{var n,o=!1;return Promise.resolve().then((async()=>({...r,contextValue:await r.contextValue}))).then((r=>{if(!o)return"subscription"===e.kind?i(r):l(r)})).then((r=>{if(!o&&r){if(d&&r[d]){n=r[d]();var a=null;return n.next().then((function r({done:i,value:l}){if(l&&t.next(a=a?v(a,l):s(e,l)),!i&&!o)return n.next().then(r)}))}t.next(s(e,r))}})).then((()=>{t.complete()})).catch((r=>{t.next(c(e,r)),t.complete()})),()=>{n&&n.return&&n.return(),o=!0}})))(e,{schema:f,document:e.query,rootValue:m,contextValue:x,variableValues:k,operationName:u(e.query),fieldResolver:p,typeResolver:y,subscribeFieldResolver:h}))}))(t((e=>"query"===e.kind||"mutation"===e.kind||"subscription"===e.kind))(R)),q=x(t((e=>"teardown"===e.kind))(R));return o([V,q])};export{f as executeExchange};
//# sourceMappingURL=urql-exchange-execute.min.mjs.map
